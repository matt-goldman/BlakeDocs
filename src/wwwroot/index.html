<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BlakeSampleDocs</title>
    <base href="/" />
    <link rel="stylesheet" href="lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/app.css" />
    <link rel="stylesheet" href="_content/BlakePlugin.DocsRenderer/lib/css/plugin.css" />
    <link rel="icon" type="image/png" href="favicon.png" />
    <link href="BlakeSampleDocs.styles.css" rel="stylesheet" />
</head>

<body>
    <div id="app">
        <div class="loader"></div>
    </div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="." class="reload">Reload</a>
        <span class="dismiss">ðŸ—™</span>
    </div>
    <script src="_framework/blazor.webassembly.js"></script>
    <script src="lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="_content/BlakePlugin.DocsRenderer/lib/js/prism.js"></script>
    <script src="_content/BlakePlugin.DocsRenderer/lib/js/plugin.js"></script>
    <script>
        // Function to get the current OS
        window.getOS = () => {
            const platform = navigator.platform.toLowerCase();
            return /mac/.test(platform) ? "mac" : "other";
        };

        // Focus helper
        window.focusElement = (id) => {
            const el = document.getElementById(id);
            if (el) {
                el.focus();
                // Also select the text if it's an input
                if (el.tagName === 'INPUT' && el.type === 'text') {
                    el.select();
                }
            }
        };

        window.scrollToTop = () => {
            console.log("Scrolling to top");
            // Try to find the main scrollable content area by ID first
            const mainContentById = document.getElementById("main-content");
            if (mainContentById) {
                console.log("Main content found by ID, scrolling...");
                mainContentById.scrollTo({ top: 0, behavior: 'smooth' });
                return;
            }

            // Fallback to class selector
            const mainContent = document.querySelector(".main-content");
            if (mainContent) {
                console.log("Main content element found by class, scrolling...");
                mainContent.scrollTo({ top: 0, behavior: 'smooth' });
                return;
            }

            // Final fallback to window scroll
            console.log("No main content found, trying window scroll");
            window.scrollTo({ top: 0, behavior: 'smooth' });
        };

        window.initScrollSpy = () => {
            const el = document.querySelector('[data-bs-spy="scroll"]');
            if (el) {
                bootstrap.ScrollSpy.getInstance(el)?.dispose(); // in case it's reinitialised

                // Find all anchor links in the scroll target and fix invalid IDs
                const scrollTarget = document.getElementById('bs-scroll-target');
                if (scrollTarget) {
                    const links = scrollTarget.querySelectorAll('a[href^="#"]');
                    links.forEach(link => {
                        const href = link.getAttribute('href');
                        if (href && href.length > 1) {
                            const id = href.substring(1);
                            // If the ID starts with a number, escape it for CSS
                            if (/^\d/.test(id)) {
                                const targetElement = document.getElementById(id);
                                if (targetElement) {
                                    // Update the href to use CSS.escape
                                    link.setAttribute('href', '#' + CSS.escape(id));
                                }
                            }
                        }
                    });
                }

                new bootstrap.ScrollSpy(el, {
                    target: '#bs-scroll-target',
                    rootMargin: '0px 0px -50%',
                    threshold: [0.1, 0.5, 1],
                    smoothScroll: true
                });
            }
        };


    </script>
</body>

</html>
